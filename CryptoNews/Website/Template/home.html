<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Top 10 Cryptos</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #fe5f55; /* New background color for the entire website */
            color: #333;
        }
        .carousel-item {
            height: 400px;
            background-color: #F0B67F; /* New background color for the carousel */
            color: #fff; /* Adjust text color for better contrast */
            display: none; /* Hide all items by default */
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        .carousel-item.active {
            display: flex; /* Display only active item */
        }
        .crypto-name {
            font-size: 2rem;
            font-weight: bold;
        }
        .crypto-price {
            font-size: 1.5rem;
        }
        .crypto-marketcap {
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Top 10 Cryptocurrencies</h1>
        <div id="cryptoCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner" id="cryptoCarouselInner">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let currentIndex = 0;
            let data = [];

            // Function to update carousel items with new data
            function updateCarouselItem(index) {
                const carouselInner = document.getElementById('cryptoCarouselInner');
                const carouselItems = carouselInner.getElementsByClassName('carousel-item');

                // Check if items exist
                if (carouselItems.length === 0) {
                    // No items exist, create them from scratch
                    data.forEach((crypto, idx) => {
                        const carouselItem = document.createElement('div');
                        carouselItem.className = `carousel-item ${idx === index ? 'active' : ''}`;
                        carouselItem.innerHTML = `
                            <div class="crypto-name">${crypto.name}</div>
                            <div class="crypto-price">${crypto.price} USD</div>
                            <div class="crypto-marketcap">Market Cap: ${crypto.marketcap} USD</div>
                        `;
                        carouselInner.appendChild(carouselItem);
                    });
                } else {
                    // Update existing items with new data
                    Array.from(carouselItems).forEach((item, idx) => {
                        if (idx === index) {
                            item.querySelector('.crypto-name').textContent = data[idx].name;
                            item.querySelector('.crypto-price').textContent = `${data[idx].price} USD`;
                            item.querySelector('.crypto-marketcap').textContent = `Market Cap: ${data[idx].marketcap} USD`;
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    });
                }
            }

            // Function to fetch data from API
            function fetchData() {
                fetch('/api/crypto-data/')
                    .then(response => response.json())
                    .then(fetchedData => {
                        data = fetchedData;
                        updateCarouselItem(currentIndex);
                        currentIndex = (currentIndex + 1) % data.length;
                    })
                    .catch(error => console.error('Error fetching crypto data:', error));
            }

            // Initial call to fetch data
            fetchData();

            // Fetch new data every 10 seconds
            setInterval(fetchData, 10000); // 10 seconds
        });
    </script>
</body>
</html>
